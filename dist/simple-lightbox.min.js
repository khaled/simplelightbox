!function(t,e,n,a){"use strict";t.fn.simpleLightbox=function(a){var a=t.extend({overlay:!0,container:"body",spinner:!0,nav:!0,navText:["&larr;","&rarr;"],captions:!0,captionSelector:"img",captionType:"attr",captionsData:"title",captionPosition:"bottom",close:!0,closeText:"Ã—",showCounter:!0,fileExt:"png|jpg|jpeg|gif",animationSpeed:250,preloading:!0,enableKeyboard:!0,loop:!0,docClose:!0,swipeTolerance:50,className:"simple-lightbox",widthRatio:.8,heightRatio:.9},a),i=(e.navigator.pointerEnabled||e.navigator.msPointerEnabled,0),o=t(),s=function(){var t=n.body||n.documentElement,t=t.style;return""==t.WebkitTransition?"-webkit-":""==t.MozTransition?"-moz-":""==t.OTransition?"-o-":""==t.transition?"":!1},l=!1,r=this.selector,s=s(),c=s!==!1?!0:!1,p="simplelb",d="body"===a.container,f=t("<div>").addClass("sl-overlay"+(d?" full-body":"")),u=t("<button>").addClass("sl-close").html(a.closeText),g=t("<div>").addClass("sl-spinner").html("<div></div>"),h=t("<div>").addClass("sl-navigation").html('<button class="sl-prev">'+a.navText[0]+'</button><button class="sl-next">'+a.navText[1]+"</button>"),m=t("<div>").addClass("sl-counter").html('<span class="sl-current"></span>/<span class="sl-total"></span>'),v=!1,x=0,b=t(),w=t("<div>").addClass("sl-caption "+("bottom"===a.captionPosition?"sl-caption-bottom":"sl-caption-right")),y=t("<div>").addClass("sl-wrapper").addClass(a.className).html('<div class="sl-image"></div>'),T=function(e){return"a"==t(e).prop("tagName").toLowerCase()&&new RegExp(".("+a.fileExt+")$","i").test(t(e).attr("href"))},C=function(){b=t(".sl-image"),a.close&&u.appendTo(y),a.showCounter&&t(r).length>1&&(m.appendTo(y),m.find(".sl-total").text(t(r).length)),a.nav&&h.appendTo(y),a.spinner&&g.appendTo(y)},S=function(e){e.trigger(t.Event("show.simplelightbox")),y.appendTo(a.container),a.overlay&&f.appendTo(t(a.container)),v=!0,x=t(r).index(e),o=t("<img/>").hide().attr("src",e.attr("href")),t(".sl-image").html(""),o.appendTo(t(".sl-image")),f.fadeIn("fast"),t(".sl-close").fadeIn("fast"),g.show(),h.fadeIn("fast"),t(".sl-wrapper .sl-counter .sl-current").text(x+1),m.fadeIn("fast"),E(),a.preloading&&D(),setTimeout(function(){e.trigger(t.Event("shown.simplelightbox"))},a.animationSpeed)},E=function(n){if(o.length){var i=d?e:a.container,s=new Image,p=t(i).width()*a.widthRatio,f=t(i).height()*a.heightRatio;s.src=o.attr("src"),s.onload=function(){var e=s.width,d=s.height;if(e>p||d>f){var u=e/d>p/f?e/p:d/f;e/=u,d/=u}t(".sl-image").css({top:(t(i).outerHeight(!0)-d)/2+"px",left:(t(i).outerWidth(!0)-e)/2+"px"}),g.hide(),o.css({width:e+"px",height:d+"px"}).fadeIn("fast"),l=!0;var h="self"==a.captionSelector?t(r).eq(x):t(r).eq(x).find(a.captionSelector);if("data"==a.captionType)var m=h.data(a.captionsData);else if("text"==a.captionType)var m=h.html();else var m=h.prop(a.captionsData);if(1==n||-1==n){var b={opacity:1};c?(I(0,100*n+"px"),setTimeout(function(){I(a.animationSpeed/1e3,"0px"),50})):b.left=parseInt(t(".sl-image").css("left"))+100*n+"px",t(".sl-image").animate(b,a.animationSpeed,function(){v=!1,k(m)})}else v=!1,k(m)}}},k=function(e){""!=e&&"undefined"!=typeof e&&a.captions&&w.html(e).hide().appendTo(t(".sl-image")).fadeIn("fast")},I=function(e,n){var a={};a[s+"transform"]="translateX("+n+")",a[s+"transition"]=s+"transform "+e+"s linear",t(".sl-image").css(a)},D=function(){var e=0>x+1?t(r).length-1:x+1>=t(r).length-1?0:x+1,n=0>x-1?t(r).length-1:x-1>=t(r).length-1?0:x-1;t("<img />").attr("src",t(r).eq(e).attr("href")).load(),t("<img />").attr("src",t(r).eq(n).attr("href")).load()},M=function(e){g.show();var n=x+e;if(!(v||(0>n||n>=t(r).length)&&0==a.loop)){v=!0,x=0>n?t(r).length-1:n>t(r).length-1?0:n,t(".sl-wrapper .sl-counter .sl-current").text(x+1);var s={opacity:0};c?I(a.animationSpeed/1e3,-100*e-i+"px"):s.left=parseInt(t(".sl-image").css("left"))+-100*e+"px",t(".sl-image").animate(s,a.animationSpeed,function(){setTimeout(function(){var n=t(r).eq(x);o.attr("src",n.attr("href")),t(".sl-caption").remove(),E(e),a.preloading&&D()},100)})}},P=function(){if(!v){var e=t(r).eq(x),n=!1;e.trigger(t.Event("close.simplelightbox")),t(".sl-image img, .sl-overlay, .sl-close, .sl-navigation, .sl-image .sl-caption, .sl-counter").fadeOut("fast",function(){t(".sl-wrapper, .sl-overlay").remove(),n||e.trigger(t.Event("closed.simplelightbox")),n=!0}),o=t(),l=!1}};C(),t(e).on("resize",E),t(n).on("click."+p,this.selector,function(e){if(T(this)){if(e.preventDefault(),v)return!1;S(t(this))}}),t(n).on("click",".sl-close",function(t){t.preventDefault(),l&&P()}),t(n).click(function(e){l&&a.docClose&&0==t(e.target).closest(".sl-image").length&&0==t(e.target).closest(".sl-navigation").length&&P()}),t(n).on("click",".sl-navigation button",function(e){e.preventDefault(),i=0,M(t(this).hasClass("sl-next")?1:-1)}),a.enableKeyboard&&t(n).on("keyup."+p,function(t){if(t.preventDefault(),i=0,l){var e=t.keyCode;27==e&&P(),(37==e||39==t.keyCode)&&M(39==t.keyCode?1:-1)}});var q=0,R=0,X=!1,j=0;return t(n).on("touchstart mousedown pointerdown MSPointerDown",".sl-image",function(t){return X?!0:(c&&(j=parseInt(b.css("left"))),X=!0,q=t.originalEvent.pageX||t.originalEvent.touches[0].pageX,!1)}).on("touchmove mousemove pointermove MSPointerMove",function(t){return X?(t.preventDefault(),R=t.originalEvent.pageX||t.originalEvent.touches[0].pageX,i=q-R,void(c?I(0,-i+"px"):b.css("left",j-i+"px"))):!0}).on("touchend mouseup touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",function(t){X&&(X=!1,Math.abs(i)>a.swipeTolerance?M(i>0?1:-1):c?I(a.animationSpeed/1e3,"0px"):b.animate({left:j+"px"},a.animationSpeed/2))}),this.open=function(t){S(t)},this.next=function(){M(1)},this.prev=function(){M(-1)},this.close=function(){P()},this.destroy=function(){t(n).unbind("click."+p).unbind("keyup."+p),P(),t(".sl-overlay, .sl-wrapper").remove()},this}}(jQuery,window,document);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNpbXBsZS1saWdodGJveC5qcyJdLCJuYW1lcyI6WyIkIiwid2luZG93IiwiZG9jdW1lbnQiLCJ1bmRlZmluZWQiLCJmbiIsInNpbXBsZUxpZ2h0Ym94Iiwib3B0aW9ucyIsImV4dGVuZCIsIm92ZXJsYXkiLCJjb250YWluZXIiLCJzcGlubmVyIiwibmF2IiwibmF2VGV4dCIsImNhcHRpb25zIiwiY2FwdGlvblNlbGVjdG9yIiwiY2FwdGlvblR5cGUiLCJjYXB0aW9uc0RhdGEiLCJjYXB0aW9uUG9zaXRpb24iLCJjbG9zZSIsImNsb3NlVGV4dCIsInNob3dDb3VudGVyIiwiZmlsZUV4dCIsImFuaW1hdGlvblNwZWVkIiwicHJlbG9hZGluZyIsImVuYWJsZUtleWJvYXJkIiwibG9vcCIsImRvY0Nsb3NlIiwic3dpcGVUb2xlcmFuY2UiLCJjbGFzc05hbWUiLCJ3aWR0aFJhdGlvIiwiaGVpZ2h0UmF0aW8iLCJzd2lwZURpZmYiLCJuYXZpZ2F0b3IiLCJwb2ludGVyRW5hYmxlZCIsIm1zUG9pbnRlckVuYWJsZWQiLCJjdXJJbWciLCJ0cmFuc1ByZWZpeCIsInMiLCJib2R5IiwiZG9jdW1lbnRFbGVtZW50Iiwic3R5bGUiLCJXZWJraXRUcmFuc2l0aW9uIiwiTW96VHJhbnNpdGlvbiIsIk9UcmFuc2l0aW9uIiwidHJhbnNpdGlvbiIsIm9wZW5lZCIsInNlbGVjdG9yIiwidGhpcyIsImNhblRyYW5zaXNpb25zIiwicHJlZml4IiwiZnVsbEJvZHkiLCJhZGRDbGFzcyIsImNsb3NlQnRuIiwiaHRtbCIsImNvdW50ZXIiLCJhbmltYXRpbmciLCJpbmRleCIsImltYWdlIiwiY2FwdGlvbiIsIndyYXBwZXIiLCJpc1ZhbGlkTGluayIsImVsZW1lbnQiLCJwcm9wIiwidG9Mb3dlckNhc2UiLCJSZWdFeHAiLCJ0ZXN0IiwiYXR0ciIsInNldHVwIiwiYXBwZW5kVG8iLCJsZW5ndGgiLCJmaW5kIiwidGV4dCIsIm9wZW5JbWFnZSIsImVsZW0iLCJ0cmlnZ2VyIiwiRXZlbnQiLCJoaWRlIiwiZmFkZUluIiwic2hvdyIsImFkanVzdEltYWdlIiwicHJlbG9hZCIsInNldFRpbWVvdXQiLCJkaXIiLCJ0bXBJbWFnZSIsIkltYWdlIiwid2luZG93V2lkdGgiLCJ3aWR0aCIsIndpbmRvd0hlaWdodCIsImhlaWdodCIsInNyYyIsIm9ubG9hZCIsImltYWdlV2lkdGgiLCJpbWFnZUhlaWdodCIsInJhdGlvIiwiY3NzIiwidG9wIiwib3V0ZXJIZWlnaHQiLCJsZWZ0Iiwib3V0ZXJXaWR0aCIsImNTZWwiLCJlcSIsImNhcHRpb25UZXh0IiwiZGF0YSIsIm9wYWNpdHkiLCJzbGlkZSIsInBhcnNlSW50IiwiYW5pbWF0ZSIsInNldENhcHRpb24iLCJjYXB0aW9udGV4dCIsInNwZWVkIiwicG9zIiwic3R5bGVzIiwibmV4dCIsInByZXYiLCJsb2FkIiwibG9hZEltYWdlIiwibmV3SW5kZXgiLCJyZW1vdmUiLCJ0cmlnZ2VyZWQiLCJmYWRlT3V0Iiwib24iLCJlIiwicHJldmVudERlZmF1bHQiLCJjbGljayIsInRhcmdldCIsImNsb3Nlc3QiLCJoYXNDbGFzcyIsImtleSIsImtleUNvZGUiLCJzd2lwZVN0YXJ0Iiwic3dpcGVFbmQiLCJtb3VzZWRvd24iLCJpbWFnZUxlZnQiLCJvcmlnaW5hbEV2ZW50IiwicGFnZVgiLCJ0b3VjaGVzIiwiTWF0aCIsImFicyIsIm9wZW4iLCJkZXN0cm95IiwidW5iaW5kIiwialF1ZXJ5Il0sIm1hcHBpbmdzIjoiQ0FNQyxTQUFZQSxFQUFHQyxFQUFRQyxFQUFVQyxHQUVqQyxZQUVESCxHQUFFSSxHQUFHQyxlQUFpQixTQUFVQyxHQUcvQixHQUFJQSxHQUFVTixFQUFFTyxRQUNmQyxTQUFVLEVBQ1JDLFVBQVcsT0FDYkMsU0FBVSxFQUNWQyxLQUFPLEVBQ1BDLFNBQVcsU0FBUyxVQUNwQkMsVUFBVyxFQUNYQyxnQkFBZ0IsTUFDaEJDLFlBQWEsT0FDYkMsYUFBYyxRQUNaQyxnQkFBaUIsU0FDbkJDLE9BQVMsRUFDVEMsVUFBWSxJQUNaQyxhQUFhLEVBQ1pDLFFB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R0FBSSxnREFBaUQsU0FBU0MsR0FFOUQsTUFBSVUsSUFDSlYsRUFBRUMsaUJBQ0ZRLEVBQVdULEVBQUVZLGNBQWNDLE9BQVNiLEVBQUVZLGNBQWNFLFFBQVMsR0FBSUQsTUFDakV2RyxFQUFZa0csRUFBYUMsT0FDckJsRixFQUFpQndELEVBQU8sR0FBSXpFLEVBQVksTUFDdkMwQixFQUFNcUMsSUFBSyxPQUFRc0MsRUFBWXJHLEVBQVksU0FMMUIsSUFPdEJ5RixHQUFJLG1GQUFtRixTQUFTQyxHQUU3RlUsSUFDRkEsR0FBWSxFQUNSSyxLQUFLQyxJQUFLMUcsR0FBY3pCLEVBQVFxQixlQUNuQ3dGLEVBQVdwRixFQUFZLEVBQUksRUFBSSxJQUkzQmlCLEVBQWlCd0QsRUFBT2xHLEVBQVFnQixlQUFpQixJQUFNLE9BQ3REbUMsRUFBTWlELFNBQVVULEtBQVFtQyxFQUFZLE1BQVE5SCxFQUFRZ0IsZUFBaUIsTUFNN0V5QixLQUFLMkYsS0FBTyxTQUFTakUsR0FDcEJELEVBQVVDLElBR1gxQixLQUFLaUUsS0FBTyxXQUNYRyxFQUFXLElBR1pwRSxLQUFLa0UsS0FBTyxXQUNYRSxFQUFXLEtBR1pwRSxLQUFLN0IsTUFBUSxXQUNaQSxLQUdENkIsS0FBSzRGLFFBQVUsV0FDZDNJLEVBQUVFLEdBQVUwSSxPQUFPLFNBQVMzRixHQUFRMkYsT0FBTyxTQUFTM0YsR0FDcEQvQixJQUNBbEIsRUFBRSw0QkFBNEJxSCxVQUd4QnRFLE9BR0o4RixPQUFRNUksT0FBUUMiLCJmaWxlIjoic2ltcGxlLWxpZ2h0Ym94Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuLypcblx0QnkgQW5kcsOpIFJpbmFzLCB3d3cuYW5kcmVrbmllcmllbS5kZVxuXHRBdmFpbGFibGUgZm9yIHVzZSB1bmRlciB0aGUgTUlUIExpY2Vuc2VcbiovXG5cbjsoIGZ1bmN0aW9uKCAkLCB3aW5kb3csIGRvY3VtZW50LCB1bmRlZmluZWQgKVxue1xuXHQndXNlIHN0cmljdCc7XG5cbiQuZm4uc2ltcGxlTGlnaHRib3ggPSBmdW5jdGlvbiggb3B0aW9ucyApXG57XG5cblx0dmFyIG9wdGlvbnMgPSAkLmV4dGVuZCh7XG5cdFx0b3ZlcmxheTpcdFx0dHJ1ZSxcbiAgICBjb250YWluZXI6ICdib2R5Jyxcblx0XHRzcGlubmVyOlx0XHR0cnVlLFxuXHRcdG5hdjpcdFx0XHR0cnVlLFxuXHRcdG5hdlRleHQ6XHRcdFsnJmxhcnI7JywnJnJhcnI7J10sXG5cdFx0Y2FwdGlvbnM6XHRcdHRydWUsXG5cdFx0Y2FwdGlvblNlbGVjdG9yOidpbWcnLFxuXHRcdGNhcHRpb25UeXBlOlx0J2F0dHInLFxuXHRcdGNhcHRpb25zRGF0YTpcdCd0aXRsZScsXG4gICAgY2FwdGlvblBvc2l0aW9uOiAnYm90dG9tJyxcblx0XHRjbG9zZTpcdFx0XHR0cnVlLFxuXHRcdGNsb3NlVGV4dDpcdFx0J8OXJyxcblx0XHRzaG93Q291bnRlcjpcdHRydWUsXG5cdCBcdGZpbGVFeHQ6XHRcdCdwbmd8anBnfGpwZWd8Z2lmJyxcblx0IFx0YW5pbWF0aW9uU3BlZWQ6XHQyNTAsXG5cdCBcdHByZWxvYWRpbmc6XHRcdHRydWUsXG5cdCBcdGVuYWJsZUtleWJvYXJkOlx0dHJ1ZSxcblx0IFx0bG9vcDpcdFx0XHR0cnVlLFxuXHQgXHRkb2NDbG9zZTogXHRcdHRydWUsXG5cdCBcdHN3aXBlVG9sZXJhbmNlOiA1MCxcblx0IFx0Y2xhc3NOYW1lOlx0XHQnc2ltcGxlLWxpZ2h0Ym94Jyxcblx0IFx0d2lkdGhSYXRpbzogXHQwLjgsXG5cdCBcdGhlaWdodFJhdGlvOiBcdDAuOSxcblxuXHQgfSwgb3B0aW9ucyApO1xuXG5cdC8vIGdsb2JhbCB2YXJpYWJsZXNcblx0dmFyIHRvdWNoRGV2aWNlXHQ9ICggJ29udG91Y2hzdGFydCcgaW4gd2luZG93ICksXG5cdCAgICBwb2ludGVyRW5hYmxlZCA9IHdpbmRvdy5uYXZpZ2F0b3IucG9pbnRlckVuYWJsZWQgfHwgd2luZG93Lm5hdmlnYXRvci5tc1BvaW50ZXJFbmFibGVkLFxuXHQgICAgdG91Y2hlZCA9IGZ1bmN0aW9uKCBldmVudCApe1xuICAgICAgICAgICAgaWYoIHRvdWNoRGV2aWNlICkgcmV0dXJuIHRydWU7XG5cbiAgICAgICAgICAgIGlmKCAhcG9pbnRlckVuYWJsZWQgfHwgdHlwZW9mIGV2ZW50ID09PSAndW5kZWZpbmVkJyB8fCB0eXBlb2YgZXZlbnQucG9pbnRlclR5cGUgPT09ICd1bmRlZmluZWQnIClcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgIGlmKCB0eXBlb2YgZXZlbnQuTVNQT0lOVEVSX1RZUEVfTU9VU0UgIT09ICd1bmRlZmluZWQnIClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiggZXZlbnQuTVNQT0lOVEVSX1RZUEVfTU9VU0UgIT0gZXZlbnQucG9pbnRlclR5cGUgKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBpZiggZXZlbnQucG9pbnRlclR5cGUgIT0gJ21vdXNlJyApXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIHN3aXBlRGlmZiA9IDAsXG5cdFx0Y3VySW1nID0gJCgpLFxuXHQgICAgdHJhbnNQcmVmaXggPSBmdW5jdGlvbigpe1xuXHQgICAgICAgIHZhciBzID0gZG9jdW1lbnQuYm9keSB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIHMgPSBzLnN0eWxlO1xuXHQgICAgICAgIGlmKCBzLldlYmtpdFRyYW5zaXRpb24gPT0gJycgKSByZXR1cm4gJy13ZWJraXQtJztcblx0ICAgICAgICBpZiggcy5Nb3pUcmFuc2l0aW9uID09ICcnICkgcmV0dXJuICctbW96LSc7XG5cdCAgICAgICAgaWYoIHMuT1RyYW5zaXRpb24gPT0gJycgKSByZXR1cm4gJy1vLSc7XG5cdCAgICAgICAgaWYoIHMudHJhbnNpdGlvbiA9PSAnJyApIHJldHVybiAnJztcblx0ICAgICAgICByZXR1cm4gZmFsc2U7XG5cdFx0fSxcblx0XHRvcGVuZWQgPSBmYWxzZSxcblxuXHRcdHNlbGVjdG9yID0gdGhpcy5zZWxlY3Rvcixcblx0XHR0cmFuc1ByZWZpeCA9IHRyYW5zUHJlZml4KCksXG5cdFx0Y2FuVHJhbnNpc2lvbnMgPSAodHJhbnNQcmVmaXggIT09IGZhbHNlKSA/IHRydWUgOiBmYWxzZSxcblx0XHRwcmVmaXggPSAnc2ltcGxlbGInLFxuICAgIGZ1bGxCb2R5ID0gb3B0aW9ucy5jb250YWluZXIgPT09ICdib2R5Jyxcblx0XHRvdmVybGF5ID0gJCgnPGRpdj4nKS5hZGRDbGFzcygnc2wtb3ZlcmxheScgKyAoZnVsbEJvZHkgPyAnIGZ1bGwtYm9keScgOiAnJykpLFxuXHRcdGNsb3NlQnRuID0gJCgnPGJ1dHRvbj4nKS5hZGRDbGFzcygnc2wtY2xvc2UnKS5odG1sKG9wdGlvbnMuY2xvc2VUZXh0KSxcblx0XHRzcGlubmVyID0gJCgnPGRpdj4nKS5hZGRDbGFzcygnc2wtc3Bpbm5lcicpLmh0bWwoJzxkaXY+PC9kaXY+JyksXG5cdFx0bmF2ID0gJCgnPGRpdj4nKS5hZGRDbGFzcygnc2wtbmF2aWdhdGlvbicpLmh0bWwoJzxidXR0b24gY2xhc3M9XCJzbC1wcmV2XCI+JytvcHRpb25zLm5hdlRleHRbMF0rJzwvYnV0dG9uPjxidXR0b24gY2xhc3M9XCJzbC1uZXh0XCI+JytvcHRpb25zLm5hdlRleHRbMV0rJzwvYnV0dG9uPicpLFxuXHRcdGNvdW50ZXIgPSAkKCc8ZGl2PicpLmFkZENsYXNzKCdzbC1jb3VudGVyJykuaHRtbCgnPHNwYW4gY2xhc3M9XCJzbC1jdXJyZW50XCI+PC9zcGFuPi88c3BhbiBjbGFzcz1cInNsLXRvdGFsXCI+PC9zcGFuPicpLFxuXHRcdGFuaW1hdGluZyA9IGZhbHNlLFxuXHRcdGluZGV4ID0gMCxcblx0XHRpbWFnZSA9ICQoKSxcblx0XHRjYXB0aW9uID0gJCgnPGRpdj4nKS5hZGRDbGFzcygnc2wtY2FwdGlvbiAnICsgKG9wdGlvbnMuY2FwdGlvblBvc2l0aW9uID09PSAnYm90dG9tJyA/ICdzbC1jYXB0aW9uLWJvdHRvbSc6ICdzbC1jYXB0aW9uLXJpZ2h0JykpLFxuXHRcdHdyYXBwZXIgPSAkKCc8ZGl2PicpLmFkZENsYXNzKCdzbC13cmFwcGVyJykuYWRkQ2xhc3Mob3B0aW9ucy5jbGFzc05hbWUpLmh0bWwoJzxkaXYgY2xhc3M9XCJzbC1pbWFnZVwiPjwvZGl2PicpLFxuXHRcdGlzVmFsaWRMaW5rID0gZnVuY3Rpb24oIGVsZW1lbnQgKXtcblx0XHRcdHJldHVybiAkKCBlbGVtZW50ICkucHJvcCggJ3RhZ05hbWUnICkudG9Mb3dlckNhc2UoKSA9PSAnYScgJiYgKCBuZXcgUmVnRXhwKCAnXFwuKCcgKyBvcHRpb25zLmZpbGVFeHQgKyAnKSQnLCAnaScgKSApLnRlc3QoICQoIGVsZW1lbnQgKS5hdHRyKCAnaHJlZicgKSApO1xuXHRcdH0sXG5cdFx0c2V0dXAgPSBmdW5jdGlvbigpe1xuXHRcdFx0aW1hZ2UgPSAkKCcuc2wtaW1hZ2UnKTtcblx0ICAgICAgICBpZihvcHRpb25zLmNsb3NlKSBjbG9zZUJ0bi5hcHBlbmRUbyh3cmFwcGVyKTtcblx0ICAgICAgICBpZihvcHRpb25zLnNob3dDb3VudGVyKXtcblx0ICAgICAgICBcdGlmKCQoc2VsZWN0b3IpLmxlbmd0aCA+IDEpe1xuXHQgICAgICAgIFx0XHRjb3VudGVyLmFwcGVuZFRvKHdyYXBwZXIpO1xuXHQgICAgICAgIFx0XHRjb3VudGVyLmZpbmQoJy5zbC10b3RhbCcpLnRleHQoJChzZWxlY3RvcikubGVuZ3RoKTtcblx0ICAgICAgICBcdH1cblxuXHQgICAgICAgIH1cblx0ICAgICAgICBpZihvcHRpb25zLm5hdikgbmF2LmFwcGVuZFRvKHdyYXBwZXIpO1xuXHQgICAgICAgIGlmKG9wdGlvbnMuc3Bpbm5lcikgc3Bpbm5lci5hcHBlbmRUbyh3cmFwcGVyKTtcblx0XHR9LFxuXHRcdG9wZW5JbWFnZSA9IGZ1bmN0aW9uKGVsZW0pe1xuXHRcdFx0ZWxlbS50cmlnZ2VyKCQuRXZlbnQoJ3Nob3cuc2ltcGxlbGlnaHRib3gnKSk7XG5cdFx0XHR3cmFwcGVyLmFwcGVuZFRvKG9wdGlvbnMuY29udGFpbmVyKTtcblx0XHRcdGlmKG9wdGlvbnMub3ZlcmxheSkgb3ZlcmxheS5hcHBlbmRUbygkKG9wdGlvbnMuY29udGFpbmVyKSk7XG5cdFx0XHRhbmltYXRpbmcgPSB0cnVlO1xuXHRcdFx0aW5kZXggPSAkKHNlbGVjdG9yKS5pbmRleChlbGVtKTtcblx0ICAgICAgICBjdXJJbWcgPSAkKCAnPGltZy8+JyApXG5cdCAgICAgICAgLmhpZGUoKVxuXHQgICAgICAgIC5hdHRyKCdzcmMnLCBlbGVtLmF0dHIoJ2hyZWYnKSk7XG5cdCAgICAgICAgJCgnLnNsLWltYWdlJykuaHRtbCgnJyk7XG4gICAgICAgIFx0Y3VySW1nLmFwcGVuZFRvKCQoJy5zbC1pbWFnZScpKTtcbiAgICAgICAgXHRvdmVybGF5LmZhZGVJbignZmFzdCcpO1xuICAgICAgICBcdCQoJy5zbC1jbG9zZScpLmZhZGVJbignZmFzdCcpO1xuICAgICAgICBcdHNwaW5uZXIuc2hvdygpO1xuICAgICAgICBcdG5hdi5mYWRlSW4oJ2Zhc3QnKTtcbiAgICAgICAgXHQkKCcuc2wtd3JhcHBlciAuc2wtY291bnRlciAuc2wtY3VycmVudCcpLnRleHQoaW5kZXggKzEpO1xuICAgICAgICBcdGNvdW50ZXIuZmFkZUluKCdmYXN0Jyk7XG4gICAgICAgIFx0YWRqdXN0SW1hZ2UoKTtcbiAgICAgICAgXHRpZihvcHRpb25zLnByZWxvYWRpbmcpe1xuXHRcdCAgICBcdHByZWxvYWQoKTtcblx0XHQgICAgfVxuXHRcdCAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpeyBlbGVtLnRyaWdnZXIoJC5FdmVudCgnc2hvd24uc2ltcGxlbGlnaHRib3gnKSk7fSAsb3B0aW9ucy5hbmltYXRpb25TcGVlZCk7XG5cdFx0fSxcblx0XHRhZGp1c3RJbWFnZSA9IGZ1bmN0aW9uKGRpcil7XG5cdFx0XHRpZighY3VySW1nLmxlbmd0aCkgcmV0dXJuO1xuICAgICAgICB2YXIgY29udGFpbmVyID0gZnVsbEJvZHkgPyB3aW5kb3cgOiBvcHRpb25zLmNvbnRhaW5lcjtcbiAgICAgIFx0dmFyIHRtcEltYWdlIFx0ID0gbmV3IEltYWdlKCksXG5cdFx0XHR3aW5kb3dXaWR0aFx0ID0gJCggY29udGFpbmVyICkud2lkdGgoKSAqIG9wdGlvbnMud2lkdGhSYXRpbyxcblx0XHRcdHdpbmRvd0hlaWdodCA9ICQoIGNvbnRhaW5lciApLmhlaWdodCgpICogb3B0aW9ucy5oZWlnaHRSYXRpbztcbiAgICAgICAgXHR0bXBJbWFnZS5zcmNcdD0gY3VySW1nLmF0dHIoICdzcmMnICk7XG5cbiAgICAgICAgXHR0bXBJbWFnZS5vbmxvYWQgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGltYWdlV2lkdGhcdCA9IHRtcEltYWdlLndpZHRoLFxuXHRcdFx0XHRcdGltYWdlSGVpZ2h0XHQgPSB0bXBJbWFnZS5oZWlnaHQ7XG5cblx0XHRcdFx0aWYoIGltYWdlV2lkdGggPiB3aW5kb3dXaWR0aCB8fCBpbWFnZUhlaWdodCA+IHdpbmRvd0hlaWdodCApe1xuXHRcdFx0XHRcdHZhciByYXRpb1x0ID0gaW1hZ2VXaWR0aCAvIGltYWdlSGVpZ2h0ID4gd2luZG93V2lkdGggLyB3aW5kb3dIZWlnaHQgPyBpbWFnZVdpZHRoIC8gd2luZG93V2lkdGggOiBpbWFnZUhlaWdodCAvIHdpbmRvd0hlaWdodDtcblx0XHRcdFx0XHRpbWFnZVdpZHRoXHQvPSByYXRpbztcblx0XHRcdFx0XHRpbWFnZUhlaWdodFx0Lz0gcmF0aW87XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQkKCcuc2wtaW1hZ2UnKS5jc3Moe1xuXHRcdFx0XHRcdCd0b3AnOiAgICAoICQoIGNvbnRhaW5lciApLm91dGVySGVpZ2h0KHRydWUpIC0gaW1hZ2VIZWlnaHQgKSAvIDIgKyAncHgnLFxuXHRcdFx0XHRcdCdsZWZ0JzogICAoICQoIGNvbnRhaW5lciApLm91dGVyV2lkdGgodHJ1ZSkgLSBpbWFnZVdpZHRoICkgLyAyICsgJ3B4J1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0c3Bpbm5lci5oaWRlKCk7XG5cdFx0XHRcdGN1ckltZ1xuXHRcdFx0XHQuY3NzKHtcblx0XHRcdFx0XHQnd2lkdGgnOiAgaW1hZ2VXaWR0aCArICdweCcsXG5cdFx0XHRcdFx0J2hlaWdodCc6IGltYWdlSGVpZ2h0ICsgJ3B4J1xuXHRcdFx0XHR9KVxuXHRcdFx0XHQuZmFkZUluKCdmYXN0Jyk7XG5cdFx0XHRcdG9wZW5lZCA9IHRydWU7XG5cdFx0XHRcdHZhciBjU2VsID0gKG9wdGlvbnMuY2FwdGlvblNlbGVjdG9yID09ICdzZWxmJykgPyAkKHNlbGVjdG9yKS5lcShpbmRleCkgOiAkKHNlbGVjdG9yKS5lcShpbmRleCkuZmluZChvcHRpb25zLmNhcHRpb25TZWxlY3Rvcik7XG5cdFx0XHRcdGlmKG9wdGlvbnMuY2FwdGlvblR5cGUgPT0gJ2RhdGEnKXtcblx0XHRcdFx0XHR2YXIgY2FwdGlvblRleHQgPSBjU2VsLmRhdGEob3B0aW9ucy5jYXB0aW9uc0RhdGEpO1xuXHRcdFx0XHR9IGVsc2UgaWYob3B0aW9ucy5jYXB0aW9uVHlwZSA9PSAndGV4dCcpe1xuXHRcdFx0XHRcdHZhciBjYXB0aW9uVGV4dCA9IGNTZWwuaHRtbCgpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHZhciBjYXB0aW9uVGV4dCA9IGNTZWwucHJvcChvcHRpb25zLmNhcHRpb25zRGF0YSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZihkaXIgPT0gMSB8fCBkaXIgPT0gLTEpe1xuXHRcdFx0XHRcdHZhciBjc3MgPSB7ICdvcGFjaXR5JzogMS4wIH07XG5cdFx0XHRcdFx0aWYoIGNhblRyYW5zaXNpb25zICkge1xuXHRcdFx0XHRcdFx0c2xpZGUoMCwgMTAwICogZGlyICsgJ3B4Jyk7XG5cdFx0XHRcdFx0XHRzZXRUaW1lb3V0KCBmdW5jdGlvbigpeyBzbGlkZSggb3B0aW9ucy5hbmltYXRpb25TcGVlZCAvIDEwMDAsIDAgKyAncHgnKSwgNTAgfSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdFx0Y3NzLmxlZnQgPSBwYXJzZUludCggJCgnLnNsLWltYWdlJykuY3NzKCAnbGVmdCcgKSApICsgMTAwICogZGlyICsgJ3B4Jztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0JCgnLnNsLWltYWdlJykuYW5pbWF0ZSggY3NzLCBvcHRpb25zLmFuaW1hdGlvblNwZWVkLCBmdW5jdGlvbigpe1xuXHRcdFx0XHRcdFx0YW5pbWF0aW5nID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRzZXRDYXB0aW9uKGNhcHRpb25UZXh0KTtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGFuaW1hdGluZyA9IGZhbHNlO1xuXHRcdFx0XHRcdHNldENhcHRpb24oY2FwdGlvblRleHQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRzZXRDYXB0aW9uID0gZnVuY3Rpb24oY2FwdGlvbnRleHQpe1xuXHRcdFx0aWYoY2FwdGlvbnRleHQgIT0gJycgJiYgdHlwZW9mIGNhcHRpb250ZXh0ICE9PSBcInVuZGVmaW5lZFwiICYmIG9wdGlvbnMuY2FwdGlvbnMpe1xuXHRcdFx0XHRjYXB0aW9uLmh0bWwoY2FwdGlvbnRleHQpLmhpZGUoKS5hcHBlbmRUbygkKCcuc2wtaW1hZ2UnKSkuZmFkZUluKCdmYXN0Jyk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRzbGlkZSA9IGZ1bmN0aW9uKHNwZWVkLCBwb3Mpe1xuXHRcdHZhciBzdHlsZXMgPSB7fTtcblx0XHRcdHN0eWxlc1t0cmFuc1ByZWZpeCArICd0cmFuc2Zvcm0nXSA9ICd0cmFuc2xhdGVYKCcgKyBwb3MgKyAnKSc7XG5cdFx0XHRzdHlsZXNbdHJhbnNQcmVmaXggKyAndHJhbnNpdGlvbiddID0gdHJhbnNQcmVmaXggKyAndHJhbnNmb3JtICcgKyBzcGVlZCArICdzIGxpbmVhcic7XG5cdFx0XHQkKCcuc2wtaW1hZ2UnKS5jc3Moc3R5bGVzKTtcblx0XHR9LFxuXHRcdHByZWxvYWQgPSBmdW5jdGlvbigpe1xuXHRcdFx0dmFyIG5leHQgPSAoaW5kZXgrMSA8IDApID8gJChzZWxlY3RvcikubGVuZ3RoIC0xOiAoaW5kZXgrMSA+PSAkKHNlbGVjdG9yKS5sZW5ndGggLTEpID8gMCA6IGluZGV4KzEsXG5cdFx0XHRcdHByZXYgPSAoaW5kZXgtMSA8IDApID8gJChzZWxlY3RvcikubGVuZ3RoIC0xOiAoaW5kZXgtMSA+PSAkKHNlbGVjdG9yKS5sZW5ndGggLTEpID8gMCA6IGluZGV4LTE7XG5cdFx0XHQkKCAnPGltZyAvPicgKS5hdHRyKCAnc3JjJywgJChzZWxlY3RvcikuZXEobmV4dCkuYXR0ciggJ2hyZWYnICkgKS5sb2FkKCk7XG5cdFx0XHQkKCAnPGltZyAvPicgKS5hdHRyKCAnc3JjJywgJChzZWxlY3RvcikuZXEocHJldikuYXR0ciggJ2hyZWYnICkgKS5sb2FkKCk7XG5cblx0XHR9LFxuXHRcdGxvYWRJbWFnZSA9IGZ1bmN0aW9uKGRpcil7XG5cdFx0ICAgIHNwaW5uZXIuc2hvdygpO1xuXHRcdHZhciBuZXdJbmRleCA9IGluZGV4ICsgZGlyO1xuXHRcdFx0aWYoYW5pbWF0aW5nIHx8IChuZXdJbmRleCA8IDAgfHwgbmV3SW5kZXggPj0gJChzZWxlY3RvcikubGVuZ3RoKSAmJiBvcHRpb25zLmxvb3AgPT0gZmFsc2UgKSByZXR1cm47XG5cdFx0XHRhbmltYXRpbmcgPSB0cnVlO1xuXHRcdFx0aW5kZXggPSAobmV3SW5kZXggPCAwKSA/ICQoc2VsZWN0b3IpLmxlbmd0aCAtMTogKG5ld0luZGV4ID4gJChzZWxlY3RvcikubGVuZ3RoIC0xKSA/IDAgOiBuZXdJbmRleDtcblx0XHRcdCQoJy5zbC13cmFwcGVyIC5zbC1jb3VudGVyIC5zbC1jdXJyZW50JykudGV4dChpbmRleCArMSk7XG4gICAgICBcdHZhciBjc3MgPSB7ICdvcGFjaXR5JzogMCB9O1xuXHRcdFx0aWYoIGNhblRyYW5zaXNpb25zICkgc2xpZGUob3B0aW9ucy5hbmltYXRpb25TcGVlZCAvIDEwMDAsICggLTEwMCAqIGRpciApIC0gc3dpcGVEaWZmICsgJ3B4Jyk7XG5cdFx0XHRlbHNlIGNzcy5sZWZ0ID0gcGFyc2VJbnQoICQoJy5zbC1pbWFnZScpLmNzcyggJ2xlZnQnICkgKSArIC0xMDAgKiBkaXIgKyAncHgnO1xuXHRcdFx0JCgnLnNsLWltYWdlJykuYW5pbWF0ZSggY3NzLCBvcHRpb25zLmFuaW1hdGlvblNwZWVkLCBmdW5jdGlvbigpe1xuXHRcdFx0XHRzZXRUaW1lb3V0KCBmdW5jdGlvbigpe1xuXHRcdFx0XHRcdC8vIGZhZGVvdXQgb2xkIGltYWdlXG5cdFx0XHRcdFx0dmFyIGVsZW0gPSAkKHNlbGVjdG9yKS5lcShpbmRleCk7XG5cdFx0XHRcdFx0Y3VySW1nXG5cdFx0XHRcdFx0LmF0dHIoJ3NyYycsIGVsZW0uYXR0cignaHJlZicpKTtcblx0XHRcdFx0XHQkKCcuc2wtY2FwdGlvbicpLnJlbW92ZSgpO1xuXHRcdFx0XHRcdGFkanVzdEltYWdlKGRpcik7XG5cdFx0XHRcdFx0aWYob3B0aW9ucy5wcmVsb2FkaW5nKSBwcmVsb2FkKCk7XG5cdFx0XHRcdH0sIDEwMCk7XG5cdFx0XHR9KTtcblx0XHR9LFxuXHRcdGNsb3NlID0gZnVuY3Rpb24oKXtcblx0XHRcdGlmKGFuaW1hdGluZykgcmV0dXJuO1xuXHRcdFx0dmFyIGVsZW0gPSAkKHNlbGVjdG9yKS5lcShpbmRleCksXG5cdFx0XHRcdHRyaWdnZXJlZCA9IGZhbHNlO1xuXHRcdFx0ZWxlbS50cmlnZ2VyKCQuRXZlbnQoJ2Nsb3NlLnNpbXBsZWxpZ2h0Ym94JykpO1xuXHRcdCAgICAkKCcuc2wtaW1hZ2UgaW1nLCAuc2wtb3ZlcmxheSwgLnNsLWNsb3NlLCAuc2wtbmF2aWdhdGlvbiwgLnNsLWltYWdlIC5zbC1jYXB0aW9uLCAuc2wtY291bnRlcicpLmZhZGVPdXQoJ2Zhc3QnLCBmdW5jdGlvbigpe1xuXHRcdCAgICBcdCAkKCcuc2wtd3JhcHBlciwgLnNsLW92ZXJsYXknKS5yZW1vdmUoKTtcblx0XHQgICAgXHRpZighdHJpZ2dlcmVkKSBlbGVtLnRyaWdnZXIoJC5FdmVudCgnY2xvc2VkLnNpbXBsZWxpZ2h0Ym94JykpO1xuXHRcdCAgICBcdHRyaWdnZXJlZCA9IHRydWU7XG5cdFx0ICAgIH0pO1xuXHRcdCAgICBjdXJJbWcgPSAkKCk7XG5cdFx0ICAgIG9wZW5lZCA9IGZhbHNlO1xuXHRcdH1cblxuXHQvLyBldmVudHNcblx0c2V0dXAoKTtcblxuXHQvLyByZXNpemUvcmVzcG9uc2l2ZVxuXHQkKCB3aW5kb3cgKS5vbiggJ3Jlc2l6ZScsIGFkanVzdEltYWdlICk7XG5cblx0Ly8gb3BlbiBsaWdodGJveFxuXHQkKCBkb2N1bWVudCApLm9uKCAnY2xpY2suJytwcmVmaXgsIHRoaXMuc2VsZWN0b3IsIGZ1bmN0aW9uKCBlICl7XG5cdCAgaWYoaXNWYWxpZExpbmsodGhpcykpe1xuXHQgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHQgICAgaWYoYW5pbWF0aW5nKSByZXR1cm4gZmFsc2U7XG5cdCAgICBvcGVuSW1hZ2UoJCh0aGlzKSk7XG5cdCAgfVxuXHR9KTtcblxuXHQvLyBjbG9zZSBsaWdodGJveCBvbiBjbG9zZSBidG5cblx0JChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5zbC1jbG9zZScsIGZ1bmN0aW9uKGUpe1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRpZihvcGVuZWQpeyBjbG9zZSgpO31cblx0fSk7XG5cblx0Ly8gY2xvc2Ugb24gY2xpY2sgb24gZG9jXG5cdCQoZG9jdW1lbnQpLmNsaWNrKGZ1bmN0aW9uKGUpe1xuXHRcdGlmKG9wZW5lZCl7XG5cdFx0XHRpZigob3B0aW9ucy5kb2NDbG9zZSAmJiAkKGUudGFyZ2V0KS5jbG9zZXN0KCcuc2wtaW1hZ2UnKS5sZW5ndGggPT0gMCAmJiAkKGUudGFyZ2V0KS5jbG9zZXN0KCcuc2wtbmF2aWdhdGlvbicpLmxlbmd0aCA9PSAwKVxuXHRcdFx0KXtcblx0XHRcdFx0Y2xvc2UoKTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXG5cdC8vIG5hdi1idXR0b25zXG5cdCQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuc2wtbmF2aWdhdGlvbiBidXR0b24nLCBmdW5jdGlvbihlKXtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0c3dpcGVEaWZmID0gMDtcblx0XHRsb2FkSW1hZ2UoICQodGhpcykuaGFzQ2xhc3MoJ3NsLW5leHQnKSA/IDEgOiAtMSApO1xuXHR9KTtcblxuXHQvLyBrZXlib2FyZC1jb250cm9sXG5cdGlmKCBvcHRpb25zLmVuYWJsZUtleWJvYXJkICl7XG5cdFx0JCggZG9jdW1lbnQgKS5vbiggJ2tleXVwLicrcHJlZml4LCBmdW5jdGlvbiggZSApe1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0c3dpcGVEaWZmID0gMDtcblx0XHRcdC8vIGtleWJvYXJkIGNvbnRyb2wgb25seSBpZiBsaWdodGJveCBpcyBvcGVuXG5cdFx0XHRpZihvcGVuZWQpe1xuXHRcdFx0XHR2YXIga2V5ID0gZS5rZXlDb2RlO1xuXHRcdFx0XHRpZigga2V5ID09IDI3ICkge1xuXHRcdFx0XHRcdGNsb3NlKCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYoIGtleSA9PSAzNyB8fCBlLmtleUNvZGUgPT0gMzkgKSB7XG5cdFx0XHRcdFx0bG9hZEltYWdlKCBlLmtleUNvZGUgPT0gMzkgPyAxIDogLTEgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0Ly8gdG91Y2hjb250cm9sc1xuXHR2YXIgc3dpcGVTdGFydFx0ID0gMCxcblx0XHRzd2lwZUVuZFx0ID0gMCxcblx0XHRtb3VzZWRvd24gPSBmYWxzZSxcblx0XHRpbWFnZUxlZnQgPSAwO1xuXG5cdCQoZG9jdW1lbnQpXG5cdC5vbiggJ3RvdWNoc3RhcnQgbW91c2Vkb3duIHBvaW50ZXJkb3duIE1TUG9pbnRlckRvd24nLCAnLnNsLWltYWdlJywgZnVuY3Rpb24oZSlcblx0e1xuXHQgICAgaWYobW91c2Vkb3duKSByZXR1cm4gdHJ1ZTtcblx0XHRpZiggY2FuVHJhbnNpc2lvbnMgKSBpbWFnZUxlZnQgPSBwYXJzZUludCggaW1hZ2UuY3NzKCAnbGVmdCcgKSApO1xuXHRcdG1vdXNlZG93biA9IHRydWU7XG5cdFx0c3dpcGVTdGFydCA9IGUub3JpZ2luYWxFdmVudC5wYWdlWCB8fCBlLm9yaWdpbmFsRXZlbnQudG91Y2hlc1sgMCBdLnBhZ2VYO1xuXHRcdHJldHVybiBmYWxzZTtcblx0fSlcblx0Lm9uKCAndG91Y2htb3ZlIG1vdXNlbW92ZSBwb2ludGVybW92ZSBNU1BvaW50ZXJNb3ZlJywgZnVuY3Rpb24oZSlcblx0e1xuXHRcdGlmKCFtb3VzZWRvd24pIHJldHVybiB0cnVlO1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRzd2lwZUVuZCA9IGUub3JpZ2luYWxFdmVudC5wYWdlWCB8fCBlLm9yaWdpbmFsRXZlbnQudG91Y2hlc1sgMCBdLnBhZ2VYO1xuXHRcdHN3aXBlRGlmZiA9IHN3aXBlU3RhcnQgLSBzd2lwZUVuZDtcblx0XHRpZiggY2FuVHJhbnNpc2lvbnMgKSBzbGlkZSggMCwgLXN3aXBlRGlmZiArICdweCcgKTtcblx0XHRlbHNlIGltYWdlLmNzcyggJ2xlZnQnLCBpbWFnZUxlZnQgLSBzd2lwZURpZmYgKyAncHgnICk7XG5cdH0pXG5cdC5vbiggJ3RvdWNoZW5kIG1vdXNldXAgdG91Y2hjYW5jZWwgcG9pbnRlcnVwIHBvaW50ZXJjYW5jZWwgTVNQb2ludGVyVXAgTVNQb2ludGVyQ2FuY2VsJyxmdW5jdGlvbihlKVxuXHR7XG5cdFx0aWYobW91c2Vkb3duKXtcblx0XHRcdG1vdXNlZG93biA9IGZhbHNlO1xuXHRcdFx0aWYoIE1hdGguYWJzKCBzd2lwZURpZmYgKSA+IG9wdGlvbnMuc3dpcGVUb2xlcmFuY2UgKSB7XG5cdFx0XHRcdGxvYWRJbWFnZSggc3dpcGVEaWZmID4gMCA/IDEgOiAtMSApO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHRpZiggY2FuVHJhbnNpc2lvbnMgKSBzbGlkZSggb3B0aW9ucy5hbmltYXRpb25TcGVlZCAvIDEwMDAsIDAgKyAncHgnICk7XG5cdFx0XHRcdGVsc2UgaW1hZ2UuYW5pbWF0ZSh7ICdsZWZ0JzogaW1hZ2VMZWZ0ICsgJ3B4JyB9LCBvcHRpb25zLmFuaW1hdGlvblNwZWVkIC8gMiApO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG5cblx0Ly8gUHVibGljIG1ldGhvZHNcblx0dGhpcy5vcGVuID0gZnVuY3Rpb24oZWxlbSl7XG5cdFx0b3BlbkltYWdlKGVsZW0pO1xuXHR9XG5cblx0dGhpcy5uZXh0ID0gZnVuY3Rpb24oKXtcblx0XHRsb2FkSW1hZ2UoIDEgKTtcblx0fVxuXG5cdHRoaXMucHJldiA9IGZ1bmN0aW9uKCl7XG5cdFx0bG9hZEltYWdlKCAtMSApO1xuXHR9XG5cblx0dGhpcy5jbG9zZSA9IGZ1bmN0aW9uKCl7XG5cdFx0Y2xvc2UoKTtcblx0fVxuXG5cdHRoaXMuZGVzdHJveSA9IGZ1bmN0aW9uKCl7XG5cdFx0JChkb2N1bWVudCkudW5iaW5kKCdjbGljay4nK3ByZWZpeCkudW5iaW5kKCdrZXl1cC4nK3ByZWZpeCk7XG5cdFx0Y2xvc2UoKTtcblx0XHQkKCcuc2wtb3ZlcmxheSwgLnNsLXdyYXBwZXInKS5yZW1vdmUoKTtcblx0fVxuXG5cdHJldHVybiB0aGlzO1xuXG59O1xufSkoIGpRdWVyeSwgd2luZG93LCBkb2N1bWVudCApO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
